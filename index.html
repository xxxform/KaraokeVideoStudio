<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
    <title>KaraokeTextGenerator</title>
    <script src="./slogi.js"></script>
    <script defer src="./index.js"></script>
    <style>
        body {
            margin: 0;
            height: 100vh;
            width: 100vw;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        .main {
            position: relative;
            /* z-index: -1; */
            display: flex;
            justify-content: center;
            align-items: center;
            user-select: none;
            flex: 1 0 auto;

            .text {
                padding: 0 1em;
                > p {
                    margin: 0;
                    text-align: center;
                    font-size: 2em;

                    /* > span {
                        transition-property: color;
                        transition-duration: .1s;
                    } */
                }
            }
            #textCanvas, #backgroundCanvas {
                max-height: 100%;
                max-width: 100%;
                position: absolute;
                border: 1px solid gray;
            }
        }
        .bottom {
           flex: 0 0 auto;
            width: 100%;
        }
        audio {
            width: 100%;
        }
        .color {
            color: red;
        }
        .timeline {
            position: relative;
            height: 5em;

            .buttons {
                position: absolute;
                top: 0;
                left: 0;
                z-index: 1;
            }
            #cursor {
                left: 0%;
                position: absolute;
                height: 100%;
                width: 1px;
                border-right: 1px dashed red;
                transition-property: left;
                transition-timing-function: linear;
            }
            #words {
                width: 100%;
                height: 100%;
                > span {
                    right: 0;
                    position: absolute;
                    height: 100%;
                    display: flex;
                    border-left: 1px dotted red;
                    cursor: pointer;
                }
                > span:nth-child(3n+1) {
                    align-items: baseline;
                }
                > span:nth-child(3n+2) {
                    align-items: center;
                }
                > span:nth-child(3n+3) {
                    align-items: end;
                }
            }
        }
        .settings {
            overflow-y: auto;
            position: absolute;
            top: 0;
            right: 0;
            height: 100%;

            #toggleSettingsButton {
                background-color: rgba(128,128,128,.1);
                font-size: 5em;
                border: 0;
            }
            #toggleSettingsButton:hover {
                background-color: rgba(128,128,128,.3);
            }
            .content {
                display: none;
            }
            & input[type="number"]{
                width: 3em;
            }
        }
    </style>
</head>
<body>
    <div id="main" class="main">
        <canvas id="backgroundCanvas" width="1920" height="1080"></canvas>
        <canvas id="textCanvas" width="1920" height="1080"></canvas>

        <canvas id="renderCanvas" hidden></canvas>
        <div id="text" class="text" hidden>
            <p id="firstString"></p>
            <p id="secondString"></p>
        </div>
    </div>

    <div class="bottom">    
        <div class="timeline">
            <div class="buttons">
                <button id="plus">+</button>
                <button id="minus">-</button>
                <span id="scale"></span>
            </div>
            <div id="cursor"></div>
            <div id="words"></div>
        </div>

        <audio controls id="audio">
            
        </audio>
    </div>

    <div class="settings">
        <button id="toggleSettingsButton">...</button>
    
        <div class="content" id="settingsContent">
            <button id="splitButton">Разбить на слоги</button>
            <select id="languageSyllableAlgorythm"><option value="RU">RU</option><option value="EN" disabled>EN</option></select> 
            <!-- Подозреваю, что для EN придется асинхронно обращаться во вне или скачивать словарь с исключениями-->
            <br> 
            <textarea id="textarea" cols="30" rows="10"></textarea> <br>    

            <div class="source">
                <label>Файл <input type="file" id="fileInput" accept="audio/*"/></label> <br>
                <label>Ссылка<input type="text"></label>
            </div>

            <label>Цвет фона <input type="color" id="backgroundColor" value="#00ff00"></label> <br>
            <label>Прозрачность фона <input type="range" value="0" id="backgroundOpacity"></label> <br>
            
            <label>Шрифт <select id="fontFamily">
                <option value="Arial">Arial</option>
                <option value="Verdana">Verdana</option>
                <option value="Times New Roman">Times New Roman</option>
                <option value="Helvetica">Helvetica</option>
                <option value="Tahoma">Tahoma</option>
                <option value="Courier New">Courier New</option>
                <option value="Trebuchet MS">Trebuchet MS</option>
                <option value="Georgia">Georgia</option>
                <option value="Garamond">Garamond</option>
                <option value="Palatino Linotype">Palatino Linotype</option>
                <option value="Brush Script MT">Brush Script MT</option>
            </select>
            </label> <br>
            <label>Размер шрифта<input type="number" name="" id="fontSize"></label> <br>
            <label>Межстрочный интервал <input type="number" name="" id="lineSpacing"></label> <br>
            <label>Цвет незакрашенных слогов <input type="color" id="rightSyllableColor"></label> <br>
            <label>Цвет закрашенных слогов <input type="color" id="leftSyllableColor"></label> <br>

        </div>
    </div>
</body>

</html>